
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/Script/plugins/SkeletonExt.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, 'b3ee8wnObtHVbVVbFY8a+mj', 'SkeletonExt');
// Script/plugins/SkeletonExt.js

"use strict";

cc.game.once(cc.game.EVENT_ENGINE_INITED, function () {
  cc.js.mixin(sp.Skeleton.prototype, {
    update: function update(dt) {
      // if (CC_EDITOR) return;
      if (CC_EDITOR) {
        cc.engine._animatingInEditMode = 1;
        cc.engine.animatingInEditMode = 1;
      }

      if (this.paused) return;
      dt *= this.timeScale * sp.timeScale;

      if (this.isAnimationCached()) {
        // Cache mode and has animation queue.
        if (this._isAniComplete) {
          if (this._animationQueue.length === 0 && !this._headAniInfo) {
            var frameCache = this._frameCache;

            if (frameCache && frameCache.isInvalid()) {
              frameCache.updateToFrame();
              var frames = frameCache.frames;
              this._curFrame = frames[frames.length - 1];
            }

            return;
          }

          if (!this._headAniInfo) {
            this._headAniInfo = this._animationQueue.shift();
          }

          this._accTime += dt;

          if (this._accTime > this._headAniInfo.delay) {
            var aniInfo = this._headAniInfo;
            this._headAniInfo = null;
            this.setAnimation(0, aniInfo.animationName, aniInfo.loop);
          }

          return;
        }

        this._updateCache(dt);
      } else {
        this._updateRealtime(dt);
      }
    },
    makeSkinIno: function makeSkinIno(sf) {
      var texture = sf.getTexture();
      var rect = sf.getRect();
      var origSize = sf.getOriginalSize();
      var offset = sf.getOffset();
      var rotate = sf.isRotated(); // 匹配原生端字段名

      rect.w = rect.width;
      rect.h = rect.height;
      var info = {
        rect: rect,
        origSize: origSize,
        offset: cc.v2((origSize.width - rect.width) * 0.5 + offset.x, (origSize.height - rect.height) * 0.5 + offset.y),
        degrees: rotate ? 270 : 0,
        texture: texture
      };
      return info;
    },
    //局部换装
    changeSlotSkin: function changeSlotSkin(slotName, sf) {
      var skinInfo = this.makeSkinIno(sf);

      if (cc.sys.isNative) {
        var texture = skinInfo.texture;
        var spineSkeletonData = sp.SkeletonData.prototype;
        var textureIdx = spineSkeletonData.recordTexture(texture);
        var spTex = new middleware.Texture2D(); // spTex.setRealTexture(tex2d);

        spTex.setRealTextureIndex(textureIdx);
        spTex.setPixelsHigh(texture.height);
        spTex.setPixelsWide(texture.width);
        spTex.setNativeTexture(texture.getImpl());

        if (this._nativeSkeleton) {
          this._nativeSkeleton.updateRegion(slotName, spTex, skinInfo.rect, skinInfo.origSize, skinInfo.offset, skinInfo.degrees);
        }
      } else {
        var slot = this.findSlot(slotName);
        if (!slot) return;
        var attachment = slot.getAttachment();
        if (!attachment) return;
        var isMesh = attachment instanceof sp.spine.MeshAttachment;
        var isRegion = attachment instanceof sp.spine.RegionAttachment;
        if (!isMesh && !isRegion) return;
        attachment = slot.getAttachment().copy();
        attachment.name = slotName; // + '_copy';

        var _texture = skinInfo.texture;
        var rect = skinInfo.rect;
        var origSize = skinInfo.origSize;
        var offset = skinInfo.offset;
        var degrees = skinInfo.degrees;
        var tex2dW = rect.width;
        var tex2dH = rect.height;
        var skelTex = new sp.SkeletonTexture({
          width: tex2dW,
          height: tex2dH
        });
        skelTex.setRealTexture(_texture);
        var region = new sp.spine.TextureAtlasRegion();
        region.width = tex2dW;
        region.height = tex2dH;
        region.originalWidth = origSize.width;
        region.originalHeight = origSize.height;
        region.offsetX = offset.x;
        region.offsetY = offset.y;

        if (degrees != 0) {
          region.u = rect.x / _texture.width;
          region.v = rect.y / _texture.height;
          region.u2 = (rect.x + tex2dH) / _texture.width;
          region.v2 = (rect.y + tex2dW) / _texture.height;
        } else {
          region.u = rect.x / _texture.width;
          region.v = rect.y / _texture.height;
          region.u2 = (rect.x + tex2dW) / _texture.width;
          region.v2 = (rect.y + tex2dH) / _texture.height;
        }

        region.texture = skelTex;
        region.renderObject = region;
        region.page = attachment.region.page;
        attachment.region = region;
        attachment.width = tex2dW;
        attachment.height = tex2dH;

        if (isMesh) {
          attachment.updateUVs();
        } else if (isRegion) {
          attachment.setRegion(region);
          var uvs = attachment.uvs;

          if (degrees == 90) {
            uvs[2] = region.u;
            uvs[3] = region.v2;
            uvs[4] = region.u;
            uvs[5] = region.v;
            uvs[6] = region.u2;
            uvs[7] = region.v;
            uvs[0] = region.u2;
            uvs[1] = region.v2;
          } else if (degrees == 270) {
            uvs[6] = region.u;
            uvs[7] = region.v2;
            uvs[0] = region.u;
            uvs[1] = region.v;
            uvs[2] = region.u2;
            uvs[3] = region.v;
            uvs[4] = region.u2;
            uvs[5] = region.v2;
          } else {
            uvs[0] = region.u;
            uvs[1] = region.v2;
            uvs[2] = region.u;
            uvs[3] = region.v;
            uvs[4] = region.u2;
            uvs[5] = region.v;
            uvs[6] = region.u2;
            uvs[7] = region.v2;
          }

          attachment.updateOffset();
        }

        slot.setAttachment(attachment);
      }
    },
    // 隐藏某个slot
    setSlotVisible: function setSlotVisible(slotName, visible) {
      if (this._nativeSkeleton) {
        this._nativeSkeleton.setSlotVisible(slotName, visible);
      }
    },
    // 隐藏某个bone
    setBoneVisible: function setBoneVisible(name, visible) {
      if (this._nativeSkeleton) {
        this._nativeSkeleton.setBoneVisible(name, visible);
      }
    }
  });
});

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcU2NyaXB0XFxwbHVnaW5zXFxTa2VsZXRvbkV4dC5qcyJdLCJuYW1lcyI6WyJjYyIsImdhbWUiLCJvbmNlIiwiRVZFTlRfRU5HSU5FX0lOSVRFRCIsImpzIiwibWl4aW4iLCJzcCIsIlNrZWxldG9uIiwicHJvdG90eXBlIiwidXBkYXRlIiwiZHQiLCJDQ19FRElUT1IiLCJlbmdpbmUiLCJfYW5pbWF0aW5nSW5FZGl0TW9kZSIsImFuaW1hdGluZ0luRWRpdE1vZGUiLCJwYXVzZWQiLCJ0aW1lU2NhbGUiLCJpc0FuaW1hdGlvbkNhY2hlZCIsIl9pc0FuaUNvbXBsZXRlIiwiX2FuaW1hdGlvblF1ZXVlIiwibGVuZ3RoIiwiX2hlYWRBbmlJbmZvIiwiZnJhbWVDYWNoZSIsIl9mcmFtZUNhY2hlIiwiaXNJbnZhbGlkIiwidXBkYXRlVG9GcmFtZSIsImZyYW1lcyIsIl9jdXJGcmFtZSIsInNoaWZ0IiwiX2FjY1RpbWUiLCJkZWxheSIsImFuaUluZm8iLCJzZXRBbmltYXRpb24iLCJhbmltYXRpb25OYW1lIiwibG9vcCIsIl91cGRhdGVDYWNoZSIsIl91cGRhdGVSZWFsdGltZSIsIm1ha2VTa2luSW5vIiwic2YiLCJ0ZXh0dXJlIiwiZ2V0VGV4dHVyZSIsInJlY3QiLCJnZXRSZWN0Iiwib3JpZ1NpemUiLCJnZXRPcmlnaW5hbFNpemUiLCJvZmZzZXQiLCJnZXRPZmZzZXQiLCJyb3RhdGUiLCJpc1JvdGF0ZWQiLCJ3Iiwid2lkdGgiLCJoIiwiaGVpZ2h0IiwiaW5mbyIsInYyIiwieCIsInkiLCJkZWdyZWVzIiwiY2hhbmdlU2xvdFNraW4iLCJzbG90TmFtZSIsInNraW5JbmZvIiwic3lzIiwiaXNOYXRpdmUiLCJzcGluZVNrZWxldG9uRGF0YSIsIlNrZWxldG9uRGF0YSIsInRleHR1cmVJZHgiLCJyZWNvcmRUZXh0dXJlIiwic3BUZXgiLCJtaWRkbGV3YXJlIiwiVGV4dHVyZTJEIiwic2V0UmVhbFRleHR1cmVJbmRleCIsInNldFBpeGVsc0hpZ2giLCJzZXRQaXhlbHNXaWRlIiwic2V0TmF0aXZlVGV4dHVyZSIsImdldEltcGwiLCJfbmF0aXZlU2tlbGV0b24iLCJ1cGRhdGVSZWdpb24iLCJzbG90IiwiZmluZFNsb3QiLCJhdHRhY2htZW50IiwiZ2V0QXR0YWNobWVudCIsImlzTWVzaCIsInNwaW5lIiwiTWVzaEF0dGFjaG1lbnQiLCJpc1JlZ2lvbiIsIlJlZ2lvbkF0dGFjaG1lbnQiLCJjb3B5IiwibmFtZSIsInRleDJkVyIsInRleDJkSCIsInNrZWxUZXgiLCJTa2VsZXRvblRleHR1cmUiLCJzZXRSZWFsVGV4dHVyZSIsInJlZ2lvbiIsIlRleHR1cmVBdGxhc1JlZ2lvbiIsIm9yaWdpbmFsV2lkdGgiLCJvcmlnaW5hbEhlaWdodCIsIm9mZnNldFgiLCJvZmZzZXRZIiwidSIsInYiLCJ1MiIsInJlbmRlck9iamVjdCIsInBhZ2UiLCJ1cGRhdGVVVnMiLCJzZXRSZWdpb24iLCJ1dnMiLCJ1cGRhdGVPZmZzZXQiLCJzZXRBdHRhY2htZW50Iiwic2V0U2xvdFZpc2libGUiLCJ2aXNpYmxlIiwic2V0Qm9uZVZpc2libGUiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQ0FBLEVBQUUsQ0FBQ0MsSUFBSCxDQUFRQyxJQUFSLENBQWFGLEVBQUUsQ0FBQ0MsSUFBSCxDQUFRRSxtQkFBckIsRUFBMEMsWUFBWTtBQUVsREgsRUFBQUEsRUFBRSxDQUFDSSxFQUFILENBQU1DLEtBQU4sQ0FBWUMsRUFBRSxDQUFDQyxRQUFILENBQVlDLFNBQXhCLEVBQW1DO0FBQy9CQyxJQUFBQSxNQUQrQixrQkFDeEJDLEVBRHdCLEVBQ3BCO0FBQ1A7QUFFQSxVQUFJQyxTQUFKLEVBQWU7QUFDWFgsUUFBQUEsRUFBRSxDQUFDWSxNQUFILENBQVVDLG9CQUFWLEdBQWlDLENBQWpDO0FBQ0FiLFFBQUFBLEVBQUUsQ0FBQ1ksTUFBSCxDQUFVRSxtQkFBVixHQUFnQyxDQUFoQztBQUNIOztBQUVELFVBQUksS0FBS0MsTUFBVCxFQUFpQjtBQUVqQkwsTUFBQUEsRUFBRSxJQUFJ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VUFBVSxDQUFDNEIsWUFBWDtBQUNIOztBQUNEOUIsUUFBQUEsSUFBSSxDQUFDK0IsYUFBTCxDQUFtQjdCLFVBQW5CO0FBQ0g7QUFDSixLQXpLOEI7QUEwSy9CO0FBQ0E4QixJQUFBQSxjQTNLK0IsMEJBMktoQmxELFFBM0tnQixFQTJLTm1ELE9BM0tNLEVBMktHO0FBQzlCLFVBQUksS0FBS25DLGVBQVQsRUFBMEI7QUFDdEIsYUFBS0EsZUFBTCxDQUFxQmtDLGNBQXJCLENBQW9DbEQsUUFBcEMsRUFBOENtRCxPQUE5QztBQUNIO0FBQ0osS0EvSzhCO0FBZ0wvQjtBQUNBQyxJQUFBQSxjQWpMK0IsMEJBaUxoQnhCLElBakxnQixFQWlMVnVCLE9BakxVLEVBaUxEO0FBQzFCLFVBQUksS0FBS25DLGVBQVQsRUFBMEI7QUFDdEIsYUFBS0EsZUFBTCxDQUFxQm9DLGNBQXJCLENBQW9DeEIsSUFBcEMsRUFBMEN1QixPQUExQztBQUNIO0FBQ0o7QUFyTDhCLEdBQW5DO0FBdUxILENBekxEIiwic291cmNlUm9vdCI6Ii8iLCJzb3VyY2VzQ29udGVudCI6WyJcbmNjLmdhbWUub25jZShjYy5nYW1lLkVWRU5UX0VOR0lORV9JTklURUQsIGZ1bmN0aW9uICgpIHtcblxuICAgIGNjLmpzLm1peGluKHNwLlNrZWxldG9uLnByb3RvdHlwZSwge1xuICAgICAgICB1cGRhdGUoZHQpIHtcbiAgICAgICAgICAgIC8vIGlmIChDQ19FRElUT1IpIHJldHVybjtcblxuICAgICAgICAgICAgaWYgKENDX0VESVRPUikge1xuICAgICAgICAgICAgICAgIGNjLmVuZ2luZS5fYW5pbWF0aW5nSW5FZGl0TW9kZSA9IDE7XG4gICAgICAgICAgICAgICAgY2MuZW5naW5lLmFuaW1hdGluZ0luRWRpdE1vZGUgPSAxO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAodGhpcy5wYXVzZWQpIHJldHVybjtcblxuICAgICAgICAgICAgZHQgKj0gdGhpcy50aW1lU2NhbGUgKiBzcC50aW1lU2NhbGU7XG5cbiAgICAgICAgICAgIGlmICh0aGlzLmlzQW5pbWF0aW9uQ2FjaGVkKCkpIHtcblxuICAgICAgICAgICAgICAgIC8vIENhY2hlIG1vZGUgYW5kIGhhcyBhbmltYXRpb24gcXVldWUuXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX2lzQW5pQ29tcGxldGUpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuX2FuaW1hdGlvblF1ZXVlLmxlbmd0aCA9PT0gMCAmJiAhdGhpcy5faGVhZEFuaUluZm8pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBmcmFtZUNhY2hlID0gdGhpcy5fZnJhbWVDYWNoZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmcmFtZUNhY2hlICYmIGZyYW1lQ2FjaGUuaXNJbnZhbGlkKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmcmFtZUNhY2hlLnVwZGF0ZVRvRnJhbWUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgZnJhbWVzID0gZnJhbWVDYWNoZS5mcmFtZXM7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fY3VyRnJhbWUgPSBmcmFtZXNbZnJhbWVzLmxlbmd0aCAtIDFdO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5faGVhZEFuaUluZm8pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2hlYWRBbmlJbmZvID0gdGhpcy5fYW5pbWF0aW9uUXVldWUuc2hpZnQoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9hY2NUaW1lICs9IGR0O1xuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5fYWNjVGltZSA+IHRoaXMuX2hlYWRBbmlJbmZvLmRlbGF5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgYW5pSW5mbyA9IHRoaXMuX2hlYWRBbmlJbmZvO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5faGVhZEFuaUluZm8gPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRBbmltYXRpb24oMCwgYW5pSW5mby5hbmltYXRpb25OYW1lLCBhbmlJbmZvLmxvb3ApO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB0aGlzLl91cGRhdGVDYWNoZShkdCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuX3VwZGF0ZVJlYWx0aW1lKGR0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgbWFrZVNraW5Jbm8oc2YpIHtcbiAgICAgICAgICAgIGxldCB0ZXh0dXJlID0gc2YuZ2V0VGV4dHVyZSgpXG4gICAgICAgICAgICBsZXQgcmVjdCA9IHNmLmdldFJlY3QoKVxuICAgICAgICAgICAgbGV0IG9yaWdTaXplID0gc2YuZ2V0T3JpZ2luYWxTaXplKClcbiAgICAgICAgICAgIGxldCBvZmZzZXQgPSBzZi5nZXRPZmZzZXQoKVxuICAgICAgICAgICAgbGV0IHJvdGF0ZSA9IHNmLmlzUm90YXRlZCgpXG5cbiAgICAgICAgICAgIC8vIOWMuemFjeWOn+eUn+err+Wtl+auteWQjVxuICAgICAgICAgICAgcmVjdC53ID0gcmVjdC53aWR0aFxuICAgICAgICAgICAgcmVjdC5oID0gcmVjdC5oZWlnaHRcblxuICAgICAgICAgICAgbGV0IGluZm8gPSB7XG4gICAgICAgICAgICAgICAgcmVjdDogcmVjdCxcbiAgICAgICAgICAgICAgICBvcmlnU2l6ZTogb3JpZ1NpemUsXG4gICAgICAgICAgICAgICAgb2Zmc2V0OiBjYy52MihcbiAgICAgICAgICAgICAgICAgICAgKG9yaWdTaXplLndpZHRoIC0gcmVjdC53aWR0aCkgKiAwLjUgKyBvZmZzZXQueCxcbiAgICAgICAgICAgICAgICAgICAgKG9yaWdTaXplLmhlaWdodCAtIHJlY3QuaGVpZ2h0KSAqIDAuNSArIG9mZnNldC55XG4gICAgICAgICAgICAgICAgKSxcbiAgICAgICAgICAgICAgICBkZWdyZWVzOiByb3RhdGUgPyAyNzAgOiAwLFxuICAgICAgICAgICAgICAgIHRleHR1cmU6IHRleHR1cmUsXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiBpbmZvXG4gICAgICAgIH0sXG4gICAgICAgIC8v5bGA6YOo5o2i6KOFXG4gICAgICAgIGNoYW5nZVNsb3RTa2luKHNsb3ROYW1lLCBzZikge1xuICAgICAgICAgICAgbGV0IHNraW5JbmZvID0gdGhpcy5tYWtlU2tpbklubyhzZik7XG4gICAgICAgICAgICBpZiAoY2Muc3lzLmlzTmF0aXZlKSB7XG4gICAgICAgICAgICAgICAgbGV0IHRleHR1cmUgPSBza2luSW5mby50ZXh0dXJlO1xuICAgICAgICAgICAgICAgIGNvbnN0IHNwaW5lU2tlbGV0b25EYXRhID0gc3AuU2tlbGV0b25EYXRhLnByb3RvdHlwZTtcbiAgICAgICAgICAgICAgICBjb25zdCB0ZXh0dXJlSWR4ID0gc3BpbmVTa2VsZXRvbkRhdGEucmVjb3JkVGV4dHVyZSh0ZXh0dXJlKTtcbiAgICAgICAgICAgICAgICBjb25zdCBzcFRleCA9IG5ldyBtaWRkbGV3YXJlLlRleHR1cmUyRCgpO1xuICAgICAgICAgICAgICAgIC8vIHNwVGV4LnNldFJlYWxUZXh0dXJlKHRleDJkKTtcbiAgICAgICAgICAgICAgICBzcFRleC5zZXRSZWFsVGV4dHVyZUluZGV4KHRleHR1cmVJZHgpO1xuICAgICAgICAgICAgICAgIHNwVGV4LnNldFBpeGVsc0hpZ2godGV4dHVyZS5oZWlnaHQpO1xuICAgICAgICAgICAgICAgIHNwVGV4LnNldFBpeGVsc1dpZGUodGV4dHVyZS53aWR0aCk7XG4gICAgICAgICAgICAgICAgc3BUZXguc2V0TmF0aXZlVGV4dHVyZSh0ZXh0dXJlLmdldEltcGwoKSk7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX25hdGl2ZVNrZWxldG9uKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX25hdGl2ZVNrZWxldG9uLnVwZGF0ZVJlZ2lvbihzbG90TmFtZSwgc3BUZXgsIHNraW5JbmZvLnJlY3QsIHNraW5JbmZvLm9yaWdTaXplLCBza2luSW5mby5vZmZzZXQsIHNraW5JbmZvLmRlZ3JlZXMpXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBjb25zdCBzbG90ID0gdGhpcy5maW5kU2xvdChzbG90TmFtZSk7XG4gICAgICAgICAgICAgICAgaWYgKCFzbG90KSByZXR1cm47XG4gICAgICAgICAgICAgICAgbGV0IGF0dGFjaG1lbnQgPSBzbG90LmdldEF0dGFjaG1lbnQoKTtcblxuICAgICAgICAgICAgICAgIGlmICghYXR0YWNobWVudCkgcmV0dXJuO1xuICAgICAgICAgICAgICAgIGNvbnN0IGlzTWVzaCA9IGF0dGFjaG1lbnQgaW5zdGFuY2VvZiBzcC5zcGluZS5NZXNoQXR0YWNobWVudDtcbiAgICAgICAgICAgICAgICBjb25zdCBpc1JlZ2lvbiA9IGF0dGFjaG1lbnQgaW5zdGFuY2VvZiBzcC5zcGluZS5SZWdpb25BdHRhY2htZW50O1xuICAgICAgICAgICAgICAgIGlmICghaXNNZXNoICYmICFpc1JlZ2lvbikgcmV0dXJuO1xuICAgICAgICAgICAgICAgIGF0dGFjaG1lbnQgPSBzbG90LmdldEF0dGFjaG1lbnQoKS5jb3B5KCk7XG4gICAgICAgICAgICAgICAgYXR0YWNobWVudC5uYW1lID0gc2xvdE5hbWU7IC8vICsgJ19jb3B5JztcblxuICAgICAgICAgICAgICAgIGxldCB0ZXh0dXJlID0gc2tpbkluZm8udGV4dHVyZTtcbiAgICAgICAgICAgICAgICBsZXQgcmVjdCA9IHNraW5JbmZvLnJlY3RcbiAgICAgICAgICAgICAgICBsZXQgb3JpZ1NpemUgPSBza2luSW5mby5vcmlnU2l6ZVxuICAgICAgICAgICAgICAgIGxldCBvZmZzZXQgPSBza2luSW5mby5vZmZzZXRcbiAgICAgICAgICAgICAgICBsZXQgZGVncmVlcyA9IHNraW5JbmZvLmRlZ3JlZXNcblxuICAgICAgICAgICAgICAgIGNvbnN0IHRleDJkVyA9IHJlY3Qud2lkdGg7XG4gICAgICAgICAgICAgICAgY29uc3QgdGV4MmRIID0gcmVjdC5oZWlnaHQ7XG4gICAgICAgICAgICAgICAgY29uc3Qgc2tlbFRleCA9IG5ldyBzcC5Ta2VsZXRvblRleHR1cmUoeyB3aWR0aDogdGV4MmRXLCBoZWlnaHQ6IHRleDJkSCB9KTtcbiAgICAgICAgICAgICAgICBza2VsVGV4LnNldFJlYWxUZXh0dXJlKHRleHR1cmUpO1xuXG4gICAgICAgICAgICAgICAgY29uc3QgcmVnaW9uID0gbmV3IHNwLnNwaW5lLlRleHR1cmVBdGxhc1JlZ2lvbigpO1xuICAgICAgICAgICAgICAgIHJlZ2lvbi53aWR0aCA9IHRleDJkV1xuICAgICAgICAgICAgICAgIHJlZ2lvbi5oZWlnaHQgPSB0ZXgyZEhcbiAgICAgICAgICAgICAgICByZWdpb24ub3JpZ2luYWxXaWR0aCA9IG9yaWdTaXplLndpZHRoXG4gICAgICAgICAgICAgICAgcmVnaW9uLm9yaWdpbmFsSGVpZ2h0ID0gb3JpZ1NpemUuaGVpZ2h0XG4gICAgICAgICAgICAgICAgcmVnaW9uLm9mZnNldFggPSBvZmZzZXQueFxuICAgICAgICAgICAgICAgIHJlZ2lvbi5vZmZzZXRZID0gb2Zmc2V0LnlcblxuICAgICAgICAgICAgICAgIGlmIChkZWdyZWVzICE9IDApIHtcbiAgICAgICAgICAgICAgICAgICAgcmVnaW9uLnUgPSByZWN0LnggLyB0ZXh0dXJlLndpZHRoXG4gICAgICAgICAgICAgICAgICAgIHJlZ2lvbi52ID0gcmVjdC55IC8gdGV4dHVyZS5oZWlnaHRcbiAgICAgICAgICAgICAgICAgICAgcmVnaW9uLnUyID0gKHJlY3QueCArIHRleDJkSCkgLyB0ZXh0dXJlLndpZHRoXG4gICAgICAgICAgICAgICAgICAgIHJlZ2lvbi52MiA9IChyZWN0LnkgKyB0ZXgyZFcpIC8gdGV4dHVyZS5oZWlnaHRcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZWdpb24udSA9IHJlY3QueCAvIHRleHR1cmUud2lkdGhcbiAgICAgICAgICAgICAgICAgICAgcmVnaW9uLnYgPSByZWN0LnkgLyB0ZXh0dXJlLmhlaWdodFxuICAgICAgICAgICAgICAgICAgICByZWdpb24udTIgPSAocmVjdC54ICsgdGV4MmRXKSAvIHRleHR1cmUud2lkdGhcbiAgICAgICAgICAgICAgICAgICAgcmVnaW9uLnYyID0gKHJlY3QueSArIHRleDJkSCkgLyB0ZXh0dXJlLmhlaWdodFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZWdpb24udGV4dHVyZSA9IHNrZWxUZXg7XG4gICAgICAgICAgICAgICAgcmVnaW9uLnJlbmRlck9iamVjdCA9IHJlZ2lvbjtcbiAgICAgICAgICAgICAgICByZWdpb24ucGFnZSA9IGF0dGFjaG1lbnQucmVnaW9uLnBhZ2U7XG5cbiAgICAgICAgICAgICAgICBhdHRhY2htZW50LnJlZ2lvbiA9IHJlZ2lvbjtcbiAgICAgICAgICAgICAgICBhdHRhY2htZW50LndpZHRoID0gdGV4MmRXO1xuICAgICAgICAgICAgICAgIGF0dGFjaG1lbnQuaGVpZ2h0ID0gdGV4MmRIO1xuICAgICAgICAgICAgICAgIGlmIChpc01lc2gpIHtcbiAgICAgICAgICAgICAgICAgICAgYXR0YWNobWVudC51cGRhdGVVVnMoKTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGlzUmVnaW9uKSB7XG4gICAgICAgICAgICAgICAgICAgIGF0dGFjaG1lbnQuc2V0UmVnaW9uKHJlZ2lvbik7XG4gICAgICAgICAgICAgICAgICAgIGxldCB1dnMgPSBhdHRhY2htZW50LnV2cztcbiAgICAgICAgICAgICAgICAgICAgaWYgKGRlZ3JlZXMgPT0gOTApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHV2c1syXSA9IHJlZ2lvbi51O1xuICAgICAgICAgICAgICAgICAgICAgICAgdXZzWzNdID0gcmVnaW9uLnYyO1xuICAgICAgICAgICAgICAgICAgICAgICAgdXZzWzRdID0gcmVnaW9uLnU7XG4gICAgICAgICAgICAgICAgICAgICAgICB1dnNbNV0gPSByZWdpb24udjtcbiAgICAgICAgICAgICAgICAgICAgICAgIHV2c1s2XSA9IHJlZ2lvbi51MjtcbiAgICAgICAgICAgICAgICAgICAgICAgIHV2c1s3XSA9IHJlZ2lvbi52O1xuICAgICAgICAgICAgICAgICAgICAgICAgdXZzWzBdID0gcmVnaW9uLnUyO1xuICAgICAgICAgICAgICAgICAgICAgICAgdXZzWzFdID0gcmVnaW9uLnYyO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGRlZ3JlZXMgPT0gMjcwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB1dnNbNl0gPSByZWdpb24udTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHV2c1s3XSA9IHJlZ2lvbi52MjtcbiAgICAgICAgICAgICAgICAgICAgICAgIHV2c1swXSA9IHJlZ2lvbi51O1xuICAgICAgICAgICAgICAgICAgICAgICAgdXZzWzFdID0gcmVnaW9uLnY7XG4gICAgICAgICAgICAgICAgICAgICAgICB1dnNbMl0gPSByZWdpb24udTI7XG4gICAgICAgICAgICAgICAgICAgICAgICB1dnNbM10gPSByZWdpb24udjtcbiAgICAgICAgICAgICAgICAgICAgICAgIHV2c1s0XSA9IHJlZ2lvbi51MjtcbiAgICAgICAgICAgICAgICAgICAgICAgIHV2c1s1XSA9IHJlZ2lvbi52MjtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHV2c1swXSA9IHJlZ2lvbi51O1xuICAgICAgICAgICAgICAgICAgICAgICAgdXZzWzFdID0gcmVnaW9uLnYyO1xuICAgICAgICAgICAgICAgICAgICAgICAgdXZzWzJdID0gcmVnaW9uLnU7XG4gICAgICAgICAgICAgICAgICAgICAgICB1dnNbM10gPSByZWdpb24udjtcbiAgICAgICAgICAgICAgICAgICAgICAgIHV2c1s0XSA9IHJlZ2lvbi51MjtcbiAgICAgICAgICAgICAgICAgICAgICAgIHV2c1s1XSA9IHJlZ2lvbi52O1xuICAgICAgICAgICAgICAgICAgICAgICAgdXZzWzZdID0gcmVnaW9uLnUyO1xuICAgICAgICAgICAgICAgICAgICAgICAgdXZzWzddID0gcmVnaW9uLnYyO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGF0dGFjaG1lbnQudXBkYXRlT2Zmc2V0KClcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgc2xvdC5zZXRBdHRhY2htZW50KGF0dGFjaG1lbnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICAvLyDpmpDol4/mn5DkuKpzbG90XG4gICAgICAgIHNldFNsb3RWaXNpYmxlKHNsb3ROYW1lLCB2aXNpYmxlKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5fbmF0aXZlU2tlbGV0b24pIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9uYXRpdmVTa2VsZXRvbi5zZXRTbG90VmlzaWJsZShzbG90TmFtZSwgdmlzaWJsZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIC8vIOmakOiXj+afkOS4qmJvbmVcbiAgICAgICAgc2V0Qm9uZVZpc2libGUobmFtZSwgdmlzaWJsZSkge1xuICAgICAgICAgICAgaWYgKHRoaXMuX25hdGl2ZVNrZWxldG9uKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fbmF0aXZlU2tlbGV0b24uc2V0Qm9uZVZpc2libGUobmFtZSwgdmlzaWJsZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9KVxufSlcbiJdfQ==