{"version":3,"sources":["assets\\Script\\UIManager\\TipMain\\TipMain.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["\n\nimport UIParent from \"../../Base/UIParent\";\nimport GameUtils from \"../../GameUtils/GameUtils\";\nimport TipText from \"./TipText\";\n\n\nconst { ccclass, property } = cc._decorator;\n\n@ccclass\nexport default class TipMain extends UIParent {\n    @property(cc.Node)\n    tipViewItem: cc.Node = null;\n\n    @property(cc.Node)\n    tipItemParent: cc.Node = null;\n\n    // LIFE-CYCLE CALLBACKS:\n    private _tip: any[] = [];\n\n    private _moveSpeed: number = 120;\n    private _staticTime: number = 0.35;//tip滞留时间\n    private _endY: number = 150;//tip结束位置Y\n    private _count: number = 4;//tip最多持有数量\n    private _positionY: number[] = [];\n    private _isInitData: boolean = false\n\n\n    ShowUI(data?: any, fun?: () => void) {\n        if (!this._isInitData) {\n            this._isInitData = true\n            // this._endY = (this._count - 1) * this.tipViewItem.height\n            for (let i = 0; i < this._count; i++) {\n                // let drc = ConfigManager.getInstance().getDesignResoulutionInfo();\n                // table.insert(positionY, display.center.y + (i-1)*tipNode:getContentSize().height * CC_DESIGN_RESOLUTION.scale)\n                this._positionY[i] = i * this.tipViewItem.getContentSize().height //* drc.uiScale\n            }\n        }\n        // this.setBlockInputEventEnable(false);\n        // this.showBackMask(false);\n\n        GameUtils.getInstance().setVisible(this.tipViewItem, false);\n        GameUtils.getInstance().setVisible(this.node, true);\n\n        this.createTipView(data);\n    }\n\n    _unrealOnDisable() {\n        this.tipItemParent.removeAllChildren()\n        this._tip = []\n    }\n\n    createTipView(tipContent: string) {\n        let itemNode = this.tipViewItem;\n        let item = cc.instantiate(itemNode);\n        this.tipItemParent.addChild(item)\n        GameUtils.getInstance().setVisible(item, true)\n        let sItem = item.getComponent(TipText)\n        sItem.Init(tipContent)\n        // if (this._tip.length > 4) {\n        //     this._tip[0].tipItem.hideItem();\n        //     this._tip.shift();\n        //     this.checkCloseWindow();\n        // }\n        this._tip.push({\n            time: 0,\n            tipItem: sItem,\n            fadeout: false\n        })\n        // this._tip[this._tip.length] = {\n        //     time: 0,\n        //     tipItem: sItem,\n        //     fadeout: false\n        // }\n        sItem.scheduleOnce(() => {\n            this._tip.shift();\n            sItem.hideItem();\n            this.checkCloseWindow();\n        }, 2);\n        //this.updateItemPos();\n\n    }\n\n    update(dt) {\n        if (this._tip.length <= 0) {\n            return;\n        }\n        let numY = 0\n        // let drc = ConfigManager.getInstance().getDesignResoulutionInfo();\n        let numYIndex = 0\n        for (let i = this._tip.length - 1; i >= 0; i--) {\n            if (numYIndex < this._count) {\n                numY += (numYIndex == 0) ? 0 : (this._tip[i].tipItem.node.height / 2 + this._tip[i + 1].tipItem.node.height / 2) //* drc.uiScale\n                this._positionY[numYIndex] = numY\n                numYIndex++\n            }\n        }\n        for (let index = 0; index < this._count; index++) {\n            if (!this._tip[index]) {\n                numY += this.tipViewItem.getContentSize().height //* drc.uiScale\n                this._positionY[index] = numY\n            }\n        }\n        this._endY = this._positionY[this._positionY.length - 1]\n        for (let index = 0; index < this._tip.length; index++) {\n            let index_2 = this._tip.length - index - 1\n            if (index_2 >= this._count - 1) {\n                index_2 = this._count - 1\n            }\n\n            let tipData = this._tip[index]\n            tipData.time = tipData.time + dt\n\n            if (index_2 != -1) {\n                if (index_2 < this._count && tipData.tipItem.node.y <= this._positionY[index_2]) {\n                    tipData.tipItem.node.y = this._positionY[index_2]\n                }\n            }\n\n            if (tipData.time >= this._staticTime) {\n                //this._tip[i].tipItem.node.y += this._moveSpeed * dt;\n                let y = tipData.tipItem.node.y\n                let v = Math.abs((this._positionY[2] - y) / (1 - tipData.time))\n                tipData.tipItem.node.y += v * dt\n                if (tipData.tipItem.node.y > this._endY) {\n                    tipData.tipItem.node.y = this._endY;\n                }\n                if (!tipData.fadeout) {\n                    tipData.fadeout = true;\n                    let time = 0.7 - ((index_2 + 1) * 0.1)\n                    cc.Tween.stopAllByTarget(tipData.tipItem.node);\n                    cc.tween(tipData.tipItem.node).to(time, { opacity: 0 }).start()\n                }\n            }\n            // if (tipData.time>=2) {\n            //     tipData.tipItem.hideItem();\n            //     this._tip.shift();\n            //     this.checkCloseWindow();\n            // }\n        }\n    }\n\n    updateItemPos() {\n        for (let i = this._tip.length - 1; i > 0; i--) {\n            let nextItem = this._tip[i - 1].tipItem.node;\n            let thisItem = this._tip[i].tipItem.node;\n            if (nextItem.y - thisItem.y < thisItem.height) {\n                nextItem.y = thisItem.y + thisItem.height;\n                if (nextItem.y > this._endY) {\n                    nextItem.y = this._endY;\n                }\n            }\n        }\n    }\n\n    // closeWinodw(isNow: boolean = false) {\n    //     // GameUtils.getInstance().setVisible(this.node, false);\n    //     if (isNow) {\n    //         this.node.destroy();\n    //     } else {\n    //         this.unrealCloseWindow();\n    //     }\n    // }\n\n    checkCloseWindow() {\n        if (this._tip.length == 0) {\n            // this.closeWinodw();\n            // this.unrealCloseWindow();\n            this.HideUI()\n        }\n    }\n}\n"]}